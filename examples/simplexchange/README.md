## Bot: simplexchange ##

A real, tunable trading bot, earning profit on market volatility.

It's trading strategy is as follows (assuming BTC/USD pair for the
sake of explanation, but every other one will do):

  * Initially it places sell orders for a defined amount of BTC above
    the current quote, with rates increasing by a constant factor
    (e.g. 1%) on each step; it also places buy orders for (almost) the
    same amount of BTC below the current quote. It starts placing
    orders from the one closest to current exchange rate, continuing
    as high (or as low) as the amount of available BTC (or USD)
    permits, respectively.

  * After a sell order is fully executed, simplexchange places
    corresponding buy order at *slightly* lower price, enough to have
    a little profit when the buy order is executed too.

  * The same applies to buy orders: when they're executed,
    corresponding sell orders are placed immediately.

  * Amounts of orders are calculated to leave the micro-profit from each
    buy/sell cycle as available funds of the account.

Risks: when the exchange rate drops or skyrockets below/above your
lowest/highest order rate, you remain with the cheaper currency (for a
while).

Upsides: It waits for real high rates to run out of your coins, and
for real low rates to buy your coins with all available... foreign
coins.  It doesn't panic.  Also there's a chance that the price
dropped or skyrocketed for not so much time, and the bot will be
better off when it retuns to the old value.

### Precondition ###

If you're unsure whether to buy *n* coins with *m* dollars at the
current rate, long term, that's a perfect situation for entrusting
your money to `simplexchange`.

Buy *n/2* coins with *m/2* dollars, and let `simplexchange` use both
kinds of currency for its orders. It can be configured to leave profit
on your account in either currency.

### Configuration ###

Simplexchange operations are configured by a strategy file (JSON),
like this:

        {
		"DESCRIPTION": "Example strategy file for btc-e bot `simplexchange'",
		"pair": "btc_usd",
		"_1_": "-- Data for possible rate evaluation",
		"base": 2518.838,
		"step": 1.0095,
		"min": 1000.0,
		"max": 9000.0,
		"_2_": "-- Connection configuration",
		"keyfile": "key.json",
		"url": "https://wex.nz",
		"_3_": "-- Order placement configuration",
		"spread": 1.006,
		"capitalize": "btc",
		"unit": 0.003,
		"upscale": 1
		}

There's also a state file (defaults to `state.json`) that is used to
keep persistent data between bot invocations (like order IDs). It's
updated in such a way to minimize harm from interrupting an operation
and starting it again.

An empty state file is created for the first time with the `init`
subcommand.

### Data used for order placement ###

Given a "base" value and a "step" quotient, possible rate values for
order placement are generated by multiplying base by step, before it
reaches "max", and dividing base by step before it reaches "min".

There is no connection between "base" value and the current exchange
rate: rate values below the base, above the base and base itself can
be used for buy or sell orders independently on their position. Look
at it as a method to generate a large, continuous list of levels from
"min" to "max", reproducibly.

Another important setting is the "unit", configuring the amount of
coins to be sold with sell orders (amounts for buy orders are close,
but they're calculated to compensate the fee and fix profit, so they
won't be neat and round even if your "unit" is).

Large "unit": less buy/sell orders possible with your funds, more
chances that the price will be "out of range" of your orders for long
intervals of time. Compensation: larger profit on each buy/sell cycle.

Small "unit": more orders, wider range, smaller profit.

An experimental "upscale" quotient is used to make higher orders sell
more coins (`upscale>1`) or less coins (`upscale<1`). When rate is
multiplied by "step" once, the amount is multiplied by upscale.

Here the "base" level comes into play again: for the "base" rate, the
amount of coins intended for sale will be exactly "unit", and amount
for lower and upper rates are adjusted by upscale as described above.

You can set "step" to a value that makes selling and rebuying on
*neighbouring* rates non-profitable. In this case, "spread" parameter
ensures that there are *several* steps between a closed order and a
corresponding replacement order, and sellRate/buyRate >= spread.

The default value of Spread is calculated to leave you at least some
profit after typical exchange fees, but not that much. Think of it as
an emergency device protecting you when experimenting with low
"step" values.

### Invocation and subcommands ###

Flags (`-strategy` and `-state`, specifying corresponding file names)
*precede* subcommand:

    simplexchange -state my.state.json init

* `init`: write a statefile (just an empty one; no connection is required).

* `place`: place orders for selling and buying coins. If there are
  already some orders placed earlier (and tracked in the statefile),
  simplexchange places new sells at rates above the highest existing
  sell, and new buys below the lowest existing buy, thus using new
  funds to exchange the price range.

* `update`: compare active orders against the state file. For any
  closed order, place a new order in the opposite direction, adjusting
  rate and amount. Doing it once a minute in a cron job is good enough
  for most market states.

* `monitor`: it's like running `update` in a loop, sleeping 2 seconds
  between invocations. More effective than a cron job if running a
  persistent task is not a problem in your environment.

* `cancel`: cancel all orders placed by simplexchange.

* `example`: write an example `key.json` and an example strategy file
  (per `-strategy` flag, defaulting to `strategy.json`) if they don't
  exist.
